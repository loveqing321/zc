package com.dale.car.admin.${module}.controller;

import com.dale.car.admin.${module}.converter.ModelConverter;
import com.dale.car.admin.${module}.dto.${DTO};
import com.dale.car.admin.${module}.dto.${Query};
import com.dale.car.admin.${module}.service.${subModule}Service;
import com.dale.car.common.dto.PageDTO;
import com.dale.car.common.dto.ResponseDTO;
import com.dale.car.common.exception.InvalidObjectException;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;
import org.springframework.web.bind.annotation.RequestBody;

import java.util.List;

@RequestMapping("/api/v1/${module}/${subModuleLower}")
@RestController
public class ${subModule}Controller {

    @Autowired
    private ${subModule}Service ${subModuleLower}Service;

    // 增加和更新记录
    @PostMapping("/save")
    public ResponseDTO save(@RequestBody ${DTO} dto) {
        try {
            if (dto.getId() != null) {
                ${subModuleLower}Service.updateById(dto);
            } else {
                ${subModuleLower}Service.add(dto);
            }
            return ResponseDTO.success();
        } catch (InvalidObjectException e) {
            return ResponseDTO.failure(e.getMessage());
        }
    }

    // 删除记录
    @GetMapping("/del")
    public ResponseDTO del(long id) {
        ${subModuleLower}Service.deleteById(id);
        return ResponseDTO.success();
    }

    // 根据Id查询指定对象
    @GetMapping("/queryById")
    public ResponseDTO queryById(long id) {
        ${DTO} dto = ${subModuleLower}Service.queryById(id);
        return ResponseDTO.success(dto);
    }

    // 分页查询
    @PostMapping("/queryByPage")
    public ResponseDTO queryByPage(@RequestBody ${Query} query) {
        PageDTO<${DTO}> queryResult = ${subModuleLower}Service.queryByPage(query);
        return ResponseDTO.success(queryResult);
    }
}
